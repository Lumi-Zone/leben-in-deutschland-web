---
import "../styles/global.css";
import LanguageSelector from '../components/LanguageSelector';
import { languages } from '../i18n/ui';

interface Props {
  title: string;
  lang?: string;
  description?: string;
  image?: string;
}

const { title, lang = 'de', description = "Kostenloses Training für den 'Leben in Deutschland' Test & Einbürgerungstest. Alle 300+ offiziellen Fragen für 2026. Jetzt üben!", image = "/social-share.jpg" } = Astro.props;
const currentPath = Astro.url.pathname;
const canonicalURL = new URL(currentPath, Astro.site || 'https://lebenindeutschland.web.app');

// Generate alternate links for SEO
const alternates = Object.keys(languages).map(l => {
  let newPath = currentPath;
  const segments = currentPath.split('/').filter(Boolean);
  if (segments.length > 0 && segments[0] in languages) {
      segments[0] = l;
      newPath = '/' + segments.join('/');
  }
  return { lang: l, href: new URL(newPath, Astro.site || 'https://lebenindeutschland.web.app').href };
});
---

<!doctype html>
<html lang={lang}>
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width" />
		<link rel="icon" href="/logo.avif" />
		<meta name="generator" content={Astro.generator} />
        
        <!-- Primary Meta Tags -->
		<title>{title}</title>
        <meta name="description" content={description} />
        <meta name="keywords" content="leben in deutschland, einbürgerungstest, bamf, 300 fragen, 310 fragen, integrationskurs, politikkurs, prüfung, 2026, test leben in deutschland, einbürgerung" />
        <link rel="canonical" href={canonicalURL} />

        <!-- Open Graph / Facebook -->
        <meta property="og:type" content="website" />
        <meta property="og:url" content={canonicalURL} />
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:image" content={new URL(image, Astro.site || 'https://lebenindeutschland.web.app')} />

        <!-- Twitter -->
        <meta property="twitter:card" content="summary_large_image" />
        <meta property="twitter:url" content={canonicalURL} />
        <meta property="twitter:title" content={title} />
        <meta property="twitter:description" content={description} />
        <meta property="twitter:image" content={new URL(image, Astro.site || 'https://lebenindeutschland.web.app')} />
        
        <!-- Hreflang for Internationalization -->
        {alternates.map(alt => (
            <link rel="alternate" hreflang={alt.lang} href={alt.href} />
        ))}
	</head>
	<body>
		<div class="fixed top-4 right-4 z-[9999] pointer-events-auto">
			<LanguageSelector currentLang={lang as any} client:load />
		</div>
		<slot />
	</body>
</html>



<style>
	html,
	body {
		margin: 0;
		width: 100%;
		height: 100%;
	}
</style>
